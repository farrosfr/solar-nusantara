---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { Image } from 'astro:assets';

export async function getStaticPaths() {
  const posts = await getCollection('berita');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: post,
  }));
}
type Props = Awaited<ReturnType<typeof getStaticPaths>>[number]['props'];

const post = Astro.props;
const { Content, headings } = await post.render();

// Pass frontmatter and headings to the main layout so it can render the TOC
const frontmatter = {
  title: post.data.title,
};
---

<Layout frontmatter={frontmatter} headings={headings}>

  <p class="text-lg text-gray-500 -mt-8 mb-8">
    Dipublikasikan pada: {post.data.pubDate.toLocaleDateString('id-ID', { year: 'numeric', month: 'long', day: 'numeric' })}
  </p>

  {post.data.heroImage && (
    <div class="mb-12 not-prose -mx-4 sm:-mx-8 md:-mx-16 lg:mx-0">
      <Image 
        src={post.data.heroImage} 
        alt={post.data.title} 
        width={1200} 
        height={600} 
        class="w-full h-auto object-cover rounded-2xl shadow-lg" 
        loading="eager" 
      />
    </div>
  )}
  
  <Content />

</Layout>