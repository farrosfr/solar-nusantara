---
// src/components/Navbar.astro

// Updated navLinks with nested children for "Tentang"
const navLinks = [
  { href: "/", text: "Beranda" },
  { 
    href: "/tentang", 
    text: "Tentang",
    children: [
      { 
        href: "/tentang/profil", 
        text: "Profil Perusahaan",
        children: [
          { href: "/tentang/profil/sejarah", text: "Sejarah" },
          { href: "/tentang/profil/penghargaan", text: "Penghargaan" },
        ]
      },
      { href: "/tentang/visi-misi", text: "Visi & Misi" },
      { href: "/tentang/manajemen", text: "Manajemen" },
    ]
  },
  { href: "/layanan", text: "Layanan" },
  { href: "/produk", text: "Produk" },
  { href: "/pintar", text: "Pintar" },
  { href: "/kontak", text: "Kontak" },
  { href: "/berita", text: "Berita" },
];

// Helper component to render links and their children recursively
const { navLinks: links } = Astro.props;
---

<nav class="hidden lg:flex w-full items-center justify-center bg-white h-16 sticky top-0 z-40 shadow-sm">
  <div class="container mx-auto px-4 flex items-center justify-center">
    <ul class="flex items-center gap-6">
      {navLinks.map(link => (
        <li class="relative group">
          <a 
            href={link.href} 
            class="flex items-center gap-2 text-center text-gray-700 font-medium transition-colors duration-300 py-2 px-4"
          >
            <span>{link.text}</span>
            {link.children && (
              <svg class="w-3 h-3 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
            )}
          </a>
          <span class="absolute -top-4 left-1/2 -translate-x-1/2 h-1 w-0 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
          
          {/* First level submenu */}
          {link.children && (
            <ul class="absolute top-full left-0 w-56 bg-white shadow-lg rounded-md hidden group-hover:block z-50">
              {link.children.map(child => (
                <li class="relative group/sub">
                  <a 
                    href={child.href} 
                    class="flex items-center justify-between w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100"
                  >
                    <span>{child.text}</span>
                    {child.children && (
                      <svg class="w-3 h-3 fill-current transform -rotate-90" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                    )}
                  </a>

                  {/* Second level sub-submenu */}
                  {child.children && (
                    <ul class="absolute top-0 left-full w-56 bg-white shadow-lg rounded-md hidden group-hover/sub:block">
                      {child.children.map(subChild => (
                        <li>
                          <a href={subChild.href} class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            {subChild.text}
                          </a>
                        </li>
                      ))}
                    </ul>
                  )}
                </li>
              ))}
            </ul>
          )}
        </li>
      ))}
    </ul>
  </div>
</nav>

<style>
  a[href="${Astro.url.pathname}"] {
    color: #1583c7;
  }
  a[href="${Astro.url.pathname}"] + span {
    width: 100%;
    background-color: #1583c7;
  }
</style>
